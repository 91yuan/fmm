<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Fast map matching: /Users/canyang/Workspace/fmm/src/mm/fmm/fmm_algorithm.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Fast map matching
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_ab09485bdc122e425bd6417e92d7acba.html">mm</a></li><li class="navelem"><a class="el" href="dir_f1b92aeda04c82d1b757f3228855d93d.html">fmm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">fmm_algorithm.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Created by Can Yang on 2020/3/22.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160; </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;mm/fmm/fmm_algorithm.hpp&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;algorithm/geom_algorithm.hpp&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;util/util.hpp&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;util/debug.hpp&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespace_f_m_m.html">FMM</a>;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespace_f_m_m_1_1_c_o_r_e.html">FMM::CORE</a>;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespace_f_m_m_1_1_n_e_t_w_o_r_k.html">FMM::NETWORK</a>;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespace_f_m_m_1_1_p_y_t_h_o_n.html">FMM::PYTHON</a>;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespace_f_m_m_1_1_m_m.html">FMM::MM</a>;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#af81f96bfaee37c461112a83f164e2126">   16</a></span>&#160;FastMapMatchConfig::FastMapMatchConfig(<span class="keywordtype">int</span> k_arg, <span class="keywordtype">double</span> r_arg,</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keywordtype">double</span> gps_error) :</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    k(k_arg), radius(r_arg), gps_error(gps_error) {</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;};</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a720739947f2b16447bf74144562614da">   21</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a720739947f2b16447bf74144562614da">FastMapMatchConfig::print</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  SPDLOG_INFO(<span class="stringliteral">&quot;FMMAlgorithmConfig&quot;</span>);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  SPDLOG_INFO(<span class="stringliteral">&quot;k {} radius {} gps_error {}&quot;</span>, <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a65233e28a3ea41c51c22a7489fec4aa6">k</a>, <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6030ad9d300d6e91339942dc9c94c552">radius</a>, <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6b1dbb396073fd4632e7fec72b207d18">gps_error</a>);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;};</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#ab690a8b4719515d8c5e78430e9eefb03">   26</a></span>&#160;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html">FastMapMatchConfig</a> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#ab690a8b4719515d8c5e78430e9eefb03">FastMapMatchConfig::load_from_xml</a>(</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keyword">const</span> boost::property_tree::ptree &amp;xml_data) {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a65233e28a3ea41c51c22a7489fec4aa6">k</a> = xml_data.get(<span class="stringliteral">&quot;config.parameters.k&quot;</span>, 8);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6030ad9d300d6e91339942dc9c94c552">radius</a> = xml_data.get(<span class="stringliteral">&quot;config.parameters.r&quot;</span>, 300.0);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6b1dbb396073fd4632e7fec72b207d18">gps_error</a> = xml_data.get(<span class="stringliteral">&quot;config.parameters.gps_error&quot;</span>, 50.0);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html">FastMapMatchConfig</a>{<a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a65233e28a3ea41c51c22a7489fec4aa6">k</a>, <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6030ad9d300d6e91339942dc9c94c552">radius</a>, <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6b1dbb396073fd4632e7fec72b207d18">gps_error</a>};</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;};</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#ac9b20f003bc1167c84cf221eec283d63">   34</a></span>&#160;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html">FastMapMatchConfig</a> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#ac9b20f003bc1167c84cf221eec283d63">FastMapMatchConfig::load_from_arg</a>(</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keyword">const</span> cxxopts::ParseResult &amp;arg_data) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a65233e28a3ea41c51c22a7489fec4aa6">k</a> = arg_data[<span class="stringliteral">&quot;candidates&quot;</span>].as&lt;<span class="keywordtype">int</span>&gt;();</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6030ad9d300d6e91339942dc9c94c552">radius</a> = arg_data[<span class="stringliteral">&quot;radius&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6b1dbb396073fd4632e7fec72b207d18">gps_error</a> = arg_data[<span class="stringliteral">&quot;error&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html">FastMapMatchConfig</a>{<a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a65233e28a3ea41c51c22a7489fec4aa6">k</a>, <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6030ad9d300d6e91339942dc9c94c552">radius</a>, <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6b1dbb396073fd4632e7fec72b207d18">gps_error</a>};</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;};</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a313354473aee028ba93a7a695a62f121">   42</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a313354473aee028ba93a7a695a62f121">FastMapMatchConfig::validate</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6b1dbb396073fd4632e7fec72b207d18">gps_error</a> &lt;= 0 || <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6030ad9d300d6e91339942dc9c94c552">radius</a> &lt;= 0 || <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a65233e28a3ea41c51c22a7489fec4aa6">k</a> &lt;= 0) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    SPDLOG_CRITICAL(<span class="stringliteral">&quot;Invalid mm parameter k {} r {} gps error {}&quot;</span>,</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                    <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a65233e28a3ea41c51c22a7489fec4aa6">k</a>, <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6030ad9d300d6e91339942dc9c94c552">radius</a>, <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6b1dbb396073fd4632e7fec72b207d18">gps_error</a>);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="class_f_m_m_1_1_m_m_1_1_fast_map_match.html#a5d29d69038868b06a9c31f762bab67f4">   51</a></span>&#160;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_match_result.html">MatchResult</a> <a class="code" href="class_f_m_m_1_1_m_m_1_1_fast_map_match.html#a5d29d69038868b06a9c31f762bab67f4">FastMapMatch::match_traj</a>(<span class="keyword">const</span> <a class="code" href="struct_f_m_m_1_1_c_o_r_e_1_1_trajectory.html">Trajectory</a> &amp;traj,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                       <span class="keyword">const</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html">FastMapMatchConfig</a> &amp;config) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  SPDLOG_TRACE(<span class="stringliteral">&quot;Count of points in trajectory {}&quot;</span>, traj.<a class="code" href="struct_f_m_m_1_1_c_o_r_e_1_1_trajectory.html#a3cd9b035cbe40dba26629030abb58305">geom</a>.<a class="code" href="class_f_m_m_1_1_c_o_r_e_1_1_line_string.html#af84353cda3ddae7afbac33883be29145">get_num_points</a>());</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  SPDLOG_TRACE(<span class="stringliteral">&quot;Search candidates&quot;</span>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="namespace_f_m_m_1_1_m_m.html#ae34897f0e60dc6a0ac89b1041d20a7b6">Traj_Candidates</a> tc = network_.<a class="code" href="class_f_m_m_1_1_n_e_t_w_o_r_k_1_1_network.html#a06edb186a8f2ccd27421daf2a8bac7ce">search_tr_cs_knn</a>(</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      traj.<a class="code" href="struct_f_m_m_1_1_c_o_r_e_1_1_trajectory.html#a3cd9b035cbe40dba26629030abb58305">geom</a>, config.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a65233e28a3ea41c51c22a7489fec4aa6">k</a>, config.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6030ad9d300d6e91339942dc9c94c552">radius</a>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  SPDLOG_TRACE(<span class="stringliteral">&quot;Trajectory candidate {}&quot;</span>, tc);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">if</span> (tc.empty()) <span class="keywordflow">return</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_match_result.html">MatchResult</a>{};</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  SPDLOG_TRACE(<span class="stringliteral">&quot;Generate transition graph&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="class_f_m_m_1_1_m_m_1_1_transition_graph.html">TransitionGraph</a> tg(tc, config.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6b1dbb396073fd4632e7fec72b207d18">gps_error</a>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  SPDLOG_TRACE(<span class="stringliteral">&quot;Update cost in transition graph&quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">// The network will be used internally to update transition graph</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="code" href="class_f_m_m_1_1_m_m_1_1_fast_map_match.html#ad4b0b5f016bfc712dad4db3c10c2c8e0">update_tg</a>(&amp;tg, traj, config);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  SPDLOG_TRACE(<span class="stringliteral">&quot;Optimal path inference&quot;</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="namespace_f_m_m_1_1_m_m.html#a44e9375751c6c81feeda010b19c1eb16">TGOpath</a> tg_opath = tg.<a class="code" href="class_f_m_m_1_1_m_m_1_1_transition_graph.html#a22164ef2df27151dd8191b79dff4ad51">backtrack</a>();</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  SPDLOG_TRACE(<span class="stringliteral">&quot;Optimal path size {}&quot;</span>, tg_opath.size());</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="namespace_f_m_m_1_1_m_m.html#a5713445758fdc15b3e6845ea5e156dc3">MatchedCandidatePath</a> matched_candidate_path(tg_opath.size());</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  std::transform(tg_opath.begin(), tg_opath.end(),</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                 matched_candidate_path.begin(),</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                 [](<span class="keyword">const</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_t_g_node.html">TGNode</a> *a) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                   return MatchedCandidate{</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                       *(a-&gt;c), a-&gt;ep, a-&gt;tp, a-&gt;sp_dist</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                   };</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                 });</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="namespace_f_m_m_1_1_m_m.html#a5fe5a4a7accb676f64dd1a9ac74ddcac">O_Path</a> opath(tg_opath.size());</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  std::transform(tg_opath.begin(), tg_opath.end(),</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                 opath.begin(),</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                 [](<span class="keyword">const</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_t_g_node.html">TGNode</a> *a) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                   return a-&gt;c-&gt;edge-&gt;id;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                 });</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  std::vector&lt;int&gt; indices;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keyword">const</span> std::vector&lt;Edge&gt; &amp;edges = network_.get_edges();</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="namespace_f_m_m_1_1_m_m.html#ab319e9bef4adb9bc00c081573b6f765b">C_Path</a> cpath = ubodt_-&gt;construct_complete_path(tg_opath, edges,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                                 &amp;indices);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  SPDLOG_TRACE(<span class="stringliteral">&quot;Cpath {}&quot;</span>, cpath);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  SPDLOG_TRACE(<span class="stringliteral">&quot;Complete path inference&quot;</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <a class="code" href="class_f_m_m_1_1_c_o_r_e_1_1_line_string.html">LineString</a> mgeom = network_.complete_path_to_geometry(</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      traj.geom, cpath);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  SPDLOG_TRACE(<span class="stringliteral">&quot;Complete path inference done&quot;</span>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_match_result.html">MatchResult</a>{</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      traj.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_match_result.html#a0446d5d9304ee111236bbfb4cfcfca57">id</a>, matched_candidate_path, opath, cpath, indices, mgeom};</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="class_f_m_m_1_1_m_m_1_1_fast_map_match.html#a5e1c6e8c8160ca3b8937a4949946d4ee">   94</a></span>&#160;<a class="code" href="struct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result.html">PyMatchResult</a> FastMapMatch::match_wkt(</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keyword">const</span> std::string &amp;wkt, <span class="keyword">const</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html">FastMapMatchConfig</a> &amp;config) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="class_f_m_m_1_1_c_o_r_e_1_1_line_string.html">LineString</a> line = <a class="code" href="namespace_f_m_m_1_1_c_o_r_e.html#a0b687e932225892c4d165994b67f07b1">wkt2linestring</a>(wkt);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  std::vector&lt;double&gt; timestamps;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="struct_f_m_m_1_1_c_o_r_e_1_1_trajectory.html">Trajectory</a> traj{0, line, timestamps};</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <a class="code" href="struct_f_m_m_1_1_m_m_1_1_match_result.html">MatchResult</a> result = match_traj(traj, config);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="struct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result.html">PyMatchResult</a> output;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  output.<a class="code" href="struct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result.html#ac7693d8ab7b07ad23fe96aa3e1244fc0">id</a> = result.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_match_result.html#a0446d5d9304ee111236bbfb4cfcfca57">id</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  output.<a class="code" href="struct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result.html#a4a85d37cadc96500402e3878a5b01343">opath</a> = result.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_match_result.html#ae782d9a7ce9a6718f92149e87b17f9fd">opath</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  output.<a class="code" href="struct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result.html#ad9f43bde5a423fa7aa1b5d3bc0d9d1f1">cpath</a> = result.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_match_result.html#a43fe3c9d1b28a6f1e709367355dcd509">cpath</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  output.<a class="code" href="struct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result.html#a327001e0d1deb5ceeb2b26a6d0a853df">mgeom</a> = result.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_match_result.html#a08b31edd0a0afeb7d532e7f270de370e">mgeom</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  output.<a class="code" href="struct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result.html#af45eb0e62513613dc24a1c1d4f7a46f3">indices</a> = result.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_match_result.html#a4aee2d2327e9f6f4029179cb176cb8e6">indices</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; result.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_match_result.html#af357c5eb450fd7a09dcbd02ade55248f">opt_candidate_path</a>.size(); ++i) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_matched_candidate.html">MatchedCandidate</a> &amp;mc = result.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_match_result.html#af357c5eb450fd7a09dcbd02ade55248f">opt_candidate_path</a>[i];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    output.<a class="code" href="struct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result.html#adbfb5013db2c6651e905ed3326fdf16b">candidates</a>.push_back(</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        {i,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;         mc.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_matched_candidate.html#a9ce7eea008a460937be04542787e1e48">c</a>.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#a73d49f48f41d7ae725d91d90b3d76cd5">edge</a>-&gt;<a class="code" href="struct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge.html#ae365a2e0c18277fe5109fb347de2a37f">id</a>,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;         graph_.get_node_id(mc.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_matched_candidate.html#a9ce7eea008a460937be04542787e1e48">c</a>.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#a73d49f48f41d7ae725d91d90b3d76cd5">edge</a>-&gt;<a class="code" href="struct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge.html#ac0978bf50901e262c32ae0b6de29e2d5">source</a>),</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;         graph_.get_node_id(mc.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_matched_candidate.html#a9ce7eea008a460937be04542787e1e48">c</a>.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#a73d49f48f41d7ae725d91d90b3d76cd5">edge</a>-&gt;<a class="code" href="struct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge.html#aea442fa7c944e87b2aea41ffb175982d">target</a>),</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;         mc.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_matched_candidate.html#a9ce7eea008a460937be04542787e1e48">c</a>.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#a01b3ffece734f634296ab1c119cbf858">dist</a>,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;         mc.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_matched_candidate.html#a9ce7eea008a460937be04542787e1e48">c</a>.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#ad3cf459cf51b459381e0e03ce7c4d4c5">offset</a>,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;         mc.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_matched_candidate.html#a9ce7eea008a460937be04542787e1e48">c</a>.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#a73d49f48f41d7ae725d91d90b3d76cd5">edge</a>-&gt;<a class="code" href="struct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge.html#a54256643086396646fbf2611ef708ea4">length</a>,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;         mc.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_matched_candidate.html#a41a90b037fa57a4d097fb5a13ed2ce70">ep</a>,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;         mc.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_matched_candidate.html#a570fdaf4ef35339477e9cddd704fa9a8">tp</a>,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;         mc.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_matched_candidate.html#a69781988abe154fd11693071be8d39b8">sp_dist</a>}</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    );</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    output.<a class="code" href="struct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result.html#acdfceb8d5b3ff3f2376f9805a39b1378">pgeom</a>.<a class="code" href="class_f_m_m_1_1_c_o_r_e_1_1_line_string.html#a792bb66beaab9c4eb008573ac715fd24">add_point</a>(mc.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_matched_candidate.html#a9ce7eea008a460937be04542787e1e48">c</a>.<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#a026650c8f5b4e7a66d2b644f5f107484">point</a>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">return</span> output;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;};</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="class_f_m_m_1_1_m_m_1_1_fast_map_match.html#a0c44d59a80fddf77684b0d967f593304">  125</a></span>&#160;<span class="keywordtype">double</span> FastMapMatch::get_sp_dist(<span class="keyword">const</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html">Candidate</a> *ca, <span class="keyword">const</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html">Candidate</a> *cb) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordtype">double</span> sp_dist = 0;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">if</span> (ca-&gt;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#a73d49f48f41d7ae725d91d90b3d76cd5">edge</a>-&gt;<a class="code" href="struct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge.html#ae365a2e0c18277fe5109fb347de2a37f">id</a> == cb-&gt;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#a73d49f48f41d7ae725d91d90b3d76cd5">edge</a>-&gt;<a class="code" href="struct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge.html#ae365a2e0c18277fe5109fb347de2a37f">id</a> &amp;&amp; ca-&gt;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#ad3cf459cf51b459381e0e03ce7c4d4c5">offset</a> &lt;= cb-&gt;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#ad3cf459cf51b459381e0e03ce7c4d4c5">offset</a>) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    sp_dist = cb-&gt;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#ad3cf459cf51b459381e0e03ce7c4d4c5">offset</a> - ca-&gt;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#ad3cf459cf51b459381e0e03ce7c4d4c5">offset</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ca-&gt;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#a73d49f48f41d7ae725d91d90b3d76cd5">edge</a>-&gt;<a class="code" href="struct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge.html#aea442fa7c944e87b2aea41ffb175982d">target</a> == cb-&gt;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#a73d49f48f41d7ae725d91d90b3d76cd5">edge</a>-&gt;<a class="code" href="struct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge.html#ac0978bf50901e262c32ae0b6de29e2d5">source</a>) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// Transition on the same OD nodes</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    sp_dist = ca-&gt;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#a73d49f48f41d7ae725d91d90b3d76cd5">edge</a>-&gt;<a class="code" href="struct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge.html#a54256643086396646fbf2611ef708ea4">length</a> - ca-&gt;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#ad3cf459cf51b459381e0e03ce7c4d4c5">offset</a> + cb-&gt;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#ad3cf459cf51b459381e0e03ce7c4d4c5">offset</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="struct_f_m_m_1_1_m_m_1_1_record.html">Record</a> *r = ubodt_-&gt;look_up(ca-&gt;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#a73d49f48f41d7ae725d91d90b3d76cd5">edge</a>-&gt;<a class="code" href="struct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge.html#aea442fa7c944e87b2aea41ffb175982d">target</a>, cb-&gt;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#a73d49f48f41d7ae725d91d90b3d76cd5">edge</a>-&gt;<a class="code" href="struct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge.html#ac0978bf50901e262c32ae0b6de29e2d5">source</a>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">// No sp path exist from O to D.</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">if</span> (r == <span class="keyword">nullptr</span>) <span class="keywordflow">return</span> ubodt_-&gt;get_delta();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// calculate original SP distance</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    sp_dist = r-&gt;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_record.html#a5a80f019d6d600a0d43f2680be3d09a7">cost</a> + ca-&gt;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#a73d49f48f41d7ae725d91d90b3d76cd5">edge</a>-&gt;<a class="code" href="struct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge.html#a54256643086396646fbf2611ef708ea4">length</a> - ca-&gt;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#ad3cf459cf51b459381e0e03ce7c4d4c5">offset</a> + cb-&gt;<a class="code" href="struct_f_m_m_1_1_m_m_1_1_candidate.html#ad3cf459cf51b459381e0e03ce7c4d4c5">offset</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordflow">return</span> sp_dist;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;}</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="class_f_m_m_1_1_m_m_1_1_fast_map_match.html#ad4b0b5f016bfc712dad4db3c10c2c8e0">  142</a></span>&#160;<span class="keywordtype">void</span> FastMapMatch::update_tg(</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="class_f_m_m_1_1_m_m_1_1_transition_graph.html">TransitionGraph</a> *tg,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_f_m_m_1_1_c_o_r_e_1_1_trajectory.html">Trajectory</a> &amp;traj, <span class="keyword">const</span> <a class="code" href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html">FastMapMatchConfig</a> &amp;config) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  SPDLOG_TRACE(<span class="stringliteral">&quot;Update transition graph&quot;</span>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  std::vector&lt;TGLayer&gt; &amp;layers = tg-&gt;<a class="code" href="class_f_m_m_1_1_m_m_1_1_transition_graph.html#a0524ced137b747586da15ed28da4712f">get_layers</a>();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  std::vector&lt;double&gt; eu_dists = <a class="code" href="namespace_f_m_m_1_1_a_l_g_o_r_i_t_h_m.html#af621c133a7effad2cbea9e614367818a">ALGORITHM::cal_eu_dist</a>(traj.<a class="code" href="struct_f_m_m_1_1_c_o_r_e_1_1_trajectory.html#a3cd9b035cbe40dba26629030abb58305">geom</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordtype">int</span> N = layers.size();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; N - 1; ++i) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    update_layer(i, &amp;(layers[i]), &amp;(layers[i + 1]),</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                 eu_dists[i]);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  SPDLOG_TRACE(<span class="stringliteral">&quot;Update transition graph done&quot;</span>);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="class_f_m_m_1_1_m_m_1_1_fast_map_match.html#a120542e086d34bbb493799227fb2dada">  156</a></span>&#160;<span class="keywordtype">void</span> FastMapMatch::update_layer(<span class="keywordtype">int</span> level,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                       <a class="code" href="namespace_f_m_m_1_1_m_m.html#acc79b4661cbb37632647cb2a8125e551">TGLayer</a> *la_ptr,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                       <a class="code" href="namespace_f_m_m_1_1_m_m.html#acc79b4661cbb37632647cb2a8125e551">TGLayer</a> *lb_ptr,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                       <span class="keywordtype">double</span> eu_dist) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  SPDLOG_TRACE(<span class="stringliteral">&quot;Update layer&quot;</span>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="namespace_f_m_m_1_1_m_m.html#acc79b4661cbb37632647cb2a8125e551">TGLayer</a> &amp;lb = *lb_ptr;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> iter_a = la_ptr-&gt;begin(); iter_a != la_ptr-&gt;end(); ++iter_a) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="namespace_f_m_m_1_1_n_e_t_w_o_r_k.html#afb9b00547afc39bc77ee8eb3d07f9bc5">NodeIndex</a> source = iter_a-&gt;c-&gt;index;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> iter_b = lb_ptr-&gt;begin(); iter_b != lb_ptr-&gt;end(); ++iter_b) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keywordtype">double</span> sp_dist = get_sp_dist(iter_a-&gt;c, iter_b-&gt;c);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordtype">double</span> tp = TransitionGraph::calc_tp(sp_dist, eu_dist);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordflow">if</span> (iter_a-&gt;cumu_prob + tp * iter_b-&gt;ep &gt;= iter_b-&gt;cumu_prob) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        iter_b-&gt;cumu_prob = iter_a-&gt;cumu_prob + tp * iter_b-&gt;ep;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        iter_b-&gt;prev = &amp;(*iter_a);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        iter_b-&gt;tp = tp;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        iter_b-&gt;sp_dist = sp_dist;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  SPDLOG_TRACE(<span class="stringliteral">&quot;Update layer done&quot;</span>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclass_f_m_m_1_1_m_m_1_1_transition_graph_html"><div class="ttname"><a href="class_f_m_m_1_1_m_m_1_1_transition_graph.html">FMM::MM::TransitionGraph</a></div><div class="ttdoc">Transition graph class in HMM.</div><div class="ttdef"><b>Definition:</b> <a href="transition__graph_8hpp_source.html#l00054">transition_graph.hpp:54</a></div></div>
<div class="ttc" id="anamespace_f_m_m_1_1_m_m_html_a5713445758fdc15b3e6845ea5e156dc3"><div class="ttname"><a href="namespace_f_m_m_1_1_m_m.html#a5713445758fdc15b3e6845ea5e156dc3">FMM::MM::MatchedCandidatePath</a></div><div class="ttdeci">std::vector&lt; MatchedCandidate &gt; MatchedCandidatePath</div><div class="ttdoc">A vector of candidates, used for representing the matching result of a trajectory.</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00064">mm_type.hpp:64</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_c_o_r_e_1_1_trajectory_html_a3cd9b035cbe40dba26629030abb58305"><div class="ttname"><a href="struct_f_m_m_1_1_c_o_r_e_1_1_trajectory.html#a3cd9b035cbe40dba26629030abb58305">FMM::CORE::Trajectory::geom</a></div><div class="ttdeci">LineString geom</div><div class="ttdoc">Geometry of the trajectory.</div><div class="ttdef"><b>Definition:</b> <a href="gps_8hpp_source.html#l00028">gps.hpp:28</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result_html_a327001e0d1deb5ceeb2b26a6d0a853df"><div class="ttname"><a href="struct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result.html#a327001e0d1deb5ceeb2b26a6d0a853df">FMM::PYTHON::PyMatchResult::mgeom</a></div><div class="ttdeci">CORE::LineString mgeom</div><div class="ttdoc">Geometry of the matched path.</div><div class="ttdef"><b>Definition:</b> <a href="pyfmm_8hpp_source.html#l00045">pyfmm.hpp:45</a></div></div>
<div class="ttc" id="anamespace_f_m_m_1_1_m_m_html_ae34897f0e60dc6a0ac89b1041d20a7b6"><div class="ttname"><a href="namespace_f_m_m_1_1_m_m.html#ae34897f0e60dc6a0ac89b1041d20a7b6">FMM::MM::Traj_Candidates</a></div><div class="ttdeci">std::vector&lt; Point_Candidates &gt; Traj_Candidates</div><div class="ttdoc">trajectory candidates</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00038">mm_type.hpp:38</a></div></div>
<div class="ttc" id="aclass_f_m_m_1_1_c_o_r_e_1_1_line_string_html_a792bb66beaab9c4eb008573ac715fd24"><div class="ttname"><a href="class_f_m_m_1_1_c_o_r_e_1_1_line_string.html#a792bb66beaab9c4eb008573ac715fd24">FMM::CORE::LineString::add_point</a></div><div class="ttdeci">void add_point(double x, double y)</div><div class="ttdoc">Add a point to the end of the current line.</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8hpp_source.html#l00079">geometry.hpp:79</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_candidate_html_a026650c8f5b4e7a66d2b644f5f107484"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_candidate.html#a026650c8f5b4e7a66d2b644f5f107484">FMM::MM::Candidate::point</a></div><div class="ttdeci">FMM::CORE::Point point</div><div class="ttdoc">boost point</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00034">mm_type.hpp:34</a></div></div>
<div class="ttc" id="anamespace_f_m_m_1_1_m_m_html_a44e9375751c6c81feeda010b19c1eb16"><div class="ttname"><a href="namespace_f_m_m_1_1_m_m.html#a44e9375751c6c81feeda010b19c1eb16">FMM::MM::TGOpath</a></div><div class="ttdeci">std::vector&lt; const TGNode * &gt; TGOpath</div><div class="ttdoc">The optimal path of nodes in the transition graph.</div><div class="ttdef"><b>Definition:</b> <a href="transition__graph_8hpp_source.html#l00046">transition_graph.hpp:46</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_candidate_html_a73d49f48f41d7ae725d91d90b3d76cd5"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_candidate.html#a73d49f48f41d7ae725d91d90b3d76cd5">FMM::MM::Candidate::edge</a></div><div class="ttdeci">NETWORK::Edge * edge</div><div class="ttdoc">candidate edge</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00033">mm_type.hpp:33</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_matched_candidate_html_a9ce7eea008a460937be04542787e1e48"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_matched_candidate.html#a9ce7eea008a460937be04542787e1e48">FMM::MM::MatchedCandidate::c</a></div><div class="ttdeci">Candidate c</div><div class="ttdoc">Candidate matched to a point.</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00054">mm_type.hpp:54</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_match_result_html"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_match_result.html">FMM::MM::MatchResult</a></div><div class="ttdoc">Map matched result representation.</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00069">mm_type.hpp:69</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result_html_adbfb5013db2c6651e905ed3326fdf16b"><div class="ttname"><a href="struct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result.html#adbfb5013db2c6651e905ed3326fdf16b">FMM::PYTHON::PyMatchResult::candidates</a></div><div class="ttdeci">std::vector&lt; PyCandidate &gt; candidates</div><div class="ttdoc">Candidate matched to each point.</div><div class="ttdef"><b>Definition:</b> <a href="pyfmm_8hpp_source.html#l00043">pyfmm.hpp:43</a></div></div>
<div class="ttc" id="aclass_f_m_m_1_1_m_m_1_1_transition_graph_html_a22164ef2df27151dd8191b79dff4ad51"><div class="ttname"><a href="class_f_m_m_1_1_m_m_1_1_transition_graph.html#a22164ef2df27151dd8191b79dff4ad51">FMM::MM::TransitionGraph::backtrack</a></div><div class="ttdeci">TGOpath backtrack()</div><div class="ttdoc">Backtrack the transition graph to find an optimal path.</div><div class="ttdef"><b>Definition:</b> <a href="transition__graph_8cpp_source.html#l00062">transition_graph.cpp:62</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_fast_map_match_config_html_a6030ad9d300d6e91339942dc9c94c552"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6030ad9d300d6e91339942dc9c94c552">FMM::MM::FastMapMatchConfig::radius</a></div><div class="ttdeci">double radius</div><div class="ttdoc">Search radius.</div><div class="ttdef"><b>Definition:</b> <a href="fmm__algorithm_8hpp_source.html#l00041">fmm_algorithm.hpp:41</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_fast_map_match_config_html_a6b1dbb396073fd4632e7fec72b207d18"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a6b1dbb396073fd4632e7fec72b207d18">FMM::MM::FastMapMatchConfig::gps_error</a></div><div class="ttdeci">double gps_error</div><div class="ttdoc">GPS error.</div><div class="ttdef"><b>Definition:</b> <a href="fmm__algorithm_8hpp_source.html#l00042">fmm_algorithm.hpp:42</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge_html_ae365a2e0c18277fe5109fb347de2a37f"><div class="ttname"><a href="struct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge.html#ae365a2e0c18277fe5109fb347de2a37f">FMM::NETWORK::Edge::id</a></div><div class="ttdeci">EdgeID id</div><div class="ttdoc">Edge ID, can be discontinuous integers.</div><div class="ttdef"><b>Definition:</b> <a href="type_8hpp_source.html#l00048">type.hpp:48</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result_html"><div class="ttname"><a href="struct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result.html">FMM::PYTHON::PyMatchResult</a></div><div class="ttdoc">POD Match result type used in Python API.</div><div class="ttdef"><b>Definition:</b> <a href="pyfmm_8hpp_source.html#l00039">pyfmm.hpp:39</a></div></div>
<div class="ttc" id="anamespace_f_m_m_1_1_m_m_html_ab319e9bef4adb9bc00c081573b6f765b"><div class="ttname"><a href="namespace_f_m_m_1_1_m_m.html#ab319e9bef4adb9bc00c081573b6f765b">FMM::MM::C_Path</a></div><div class="ttdeci">std::vector&lt; FMM::NETWORK::EdgeID &gt; C_Path</div><div class="ttdoc">Complete path, ids of a sequence of topologically connected edges.</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00047">mm_type.hpp:47</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_candidate_html_a01b3ffece734f634296ab1c119cbf858"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_candidate.html#a01b3ffece734f634296ab1c119cbf858">FMM::MM::Candidate::dist</a></div><div class="ttdeci">double dist</div><div class="ttdoc">distance from original point p to map matched point p'</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00032">mm_type.hpp:32</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_match_result_html_a43fe3c9d1b28a6f1e709367355dcd509"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_match_result.html#a43fe3c9d1b28a6f1e709367355dcd509">FMM::MM::MatchResult::cpath</a></div><div class="ttdeci">C_Path cpath</div><div class="ttdoc">the complete path, containing ids of a sequence of topologically connected edges traversed by the tra...</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00077">mm_type.hpp:77</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_fast_map_match_config_html_ab690a8b4719515d8c5e78430e9eefb03"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#ab690a8b4719515d8c5e78430e9eefb03">FMM::MM::FastMapMatchConfig::load_from_xml</a></div><div class="ttdeci">static FastMapMatchConfig load_from_xml(const boost::property_tree::ptree &amp;xml_data)</div><div class="ttdoc">Load configuration from xml data.</div><div class="ttdef"><b>Definition:</b> <a href="fmm__algorithm_8cpp_source.html#l00026">fmm_algorithm.cpp:26</a></div></div>
<div class="ttc" id="anamespace_f_m_m_html"><div class="ttname"><a href="namespace_f_m_m.html">FMM</a></div><div class="ttdoc">Fast map matching.</div><div class="ttdef"><b>Definition:</b> <a href="geom__algorithm_8hpp_source.html#l00017">geom_algorithm.hpp:17</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result_html_af45eb0e62513613dc24a1c1d4f7a46f3"><div class="ttname"><a href="struct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result.html#af45eb0e62513613dc24a1c1d4f7a46f3">FMM::PYTHON::PyMatchResult::indices</a></div><div class="ttdeci">std::vector&lt; int &gt; indices</div><div class="ttdoc">index of matched edge in the cpath</div><div class="ttdef"><b>Definition:</b> <a href="pyfmm_8hpp_source.html#l00044">pyfmm.hpp:44</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_c_o_r_e_1_1_trajectory_html"><div class="ttname"><a href="struct_f_m_m_1_1_c_o_r_e_1_1_trajectory.html">FMM::CORE::Trajectory</a></div><div class="ttdoc">Trajectory class</div><div class="ttdef"><b>Definition:</b> <a href="gps_8hpp_source.html#l00026">gps.hpp:26</a></div></div>
<div class="ttc" id="aclass_f_m_m_1_1_n_e_t_w_o_r_k_1_1_network_html_a06edb186a8f2ccd27421daf2a8bac7ce"><div class="ttname"><a href="class_f_m_m_1_1_n_e_t_w_o_r_k_1_1_network.html#a06edb186a8f2ccd27421daf2a8bac7ce">FMM::NETWORK::Network::search_tr_cs_knn</a></div><div class="ttdeci">FMM::MM::Traj_Candidates search_tr_cs_knn(FMM::CORE::Trajectory &amp;trajectory, std::size_t k, double radius) const</div><div class="ttdoc">Search for k nearest neighboring (KNN) candidates of a trajectory within a search radius.</div><div class="ttdef"><b>Definition:</b> <a href="network_8cpp_source.html#l00189">network.cpp:189</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result_html_acdfceb8d5b3ff3f2376f9805a39b1378"><div class="ttname"><a href="struct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result.html#acdfceb8d5b3ff3f2376f9805a39b1378">FMM::PYTHON::PyMatchResult::pgeom</a></div><div class="ttdeci">CORE::LineString pgeom</div><div class="ttdoc">Point position matched for each GPS point.</div><div class="ttdef"><b>Definition:</b> <a href="pyfmm_8hpp_source.html#l00046">pyfmm.hpp:46</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_match_result_html_a08b31edd0a0afeb7d532e7f270de370e"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_match_result.html#a08b31edd0a0afeb7d532e7f270de370e">FMM::MM::MatchResult::mgeom</a></div><div class="ttdeci">CORE::LineString mgeom</div><div class="ttdoc">the geometry of the matched path</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00081">mm_type.hpp:81</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_fast_map_match_config_html_a720739947f2b16447bf74144562614da"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a720739947f2b16447bf74144562614da">FMM::MM::FastMapMatchConfig::print</a></div><div class="ttdeci">void print() const</div><div class="ttdoc">Print information about this configuration.</div><div class="ttdef"><b>Definition:</b> <a href="fmm__algorithm_8cpp_source.html#l00021">fmm_algorithm.cpp:21</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_match_result_html_a0446d5d9304ee111236bbfb4cfcfca57"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_match_result.html#a0446d5d9304ee111236bbfb4cfcfca57">FMM::MM::MatchResult::id</a></div><div class="ttdeci">int id</div><div class="ttdoc">id of the trajectory to be matched</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00070">mm_type.hpp:70</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_candidate_html"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_candidate.html">FMM::MM::Candidate</a></div><div class="ttdoc">Candidate edge matched to a GPS point</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00026">mm_type.hpp:26</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_matched_candidate_html_a570fdaf4ef35339477e9cddd704fa9a8"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_matched_candidate.html#a570fdaf4ef35339477e9cddd704fa9a8">FMM::MM::MatchedCandidate::tp</a></div><div class="ttdeci">double tp</div><div class="ttdoc">transition probability to previous matched candidate</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00056">mm_type.hpp:56</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_candidate_html_ad3cf459cf51b459381e0e03ce7c4d4c5"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_candidate.html#ad3cf459cf51b459381e0e03ce7c4d4c5">FMM::MM::Candidate::offset</a></div><div class="ttdeci">double offset</div><div class="ttdoc">offset distance from the start of polyline to p'</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00031">mm_type.hpp:31</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_fast_map_match_config_html_a65233e28a3ea41c51c22a7489fec4aa6"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a65233e28a3ea41c51c22a7489fec4aa6">FMM::MM::FastMapMatchConfig::k</a></div><div class="ttdeci">int k</div><div class="ttdoc">Number of candidates.</div><div class="ttdef"><b>Definition:</b> <a href="fmm__algorithm_8hpp_source.html#l00040">fmm_algorithm.hpp:40</a></div></div>
<div class="ttc" id="anamespace_f_m_m_1_1_c_o_r_e_html"><div class="ttname"><a href="namespace_f_m_m_1_1_c_o_r_e.html">FMM::CORE</a></div><div class="ttdoc">Core data types.</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8hpp_source.html#l00022">geometry.hpp:22</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result_html_a4a85d37cadc96500402e3878a5b01343"><div class="ttname"><a href="struct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result.html#a4a85d37cadc96500402e3878a5b01343">FMM::PYTHON::PyMatchResult::opath</a></div><div class="ttdeci">MM::O_Path opath</div><div class="ttdoc">Edge ID matched for each point of the trajectory</div><div class="ttdef"><b>Definition:</b> <a href="pyfmm_8hpp_source.html#l00041">pyfmm.hpp:41</a></div></div>
<div class="ttc" id="aclass_f_m_m_1_1_c_o_r_e_1_1_line_string_html"><div class="ttname"><a href="class_f_m_m_1_1_c_o_r_e_1_1_line_string.html">FMM::CORE::LineString</a></div><div class="ttdoc">Linestring geometry class.</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8hpp_source.html#l00034">geometry.hpp:34</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_match_result_html_af357c5eb450fd7a09dcbd02ade55248f"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_match_result.html#af357c5eb450fd7a09dcbd02ade55248f">FMM::MM::MatchResult::opt_candidate_path</a></div><div class="ttdeci">MatchedCandidatePath opt_candidate_path</div><div class="ttdoc">A vector of candidate matched to each point of a trajectory.</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00071">mm_type.hpp:71</a></div></div>
<div class="ttc" id="anamespace_f_m_m_1_1_m_m_html"><div class="ttname"><a href="namespace_f_m_m_1_1_m_m.html">FMM::MM</a></div><div class="ttdoc">Class related with map matching.</div><div class="ttdef"><b>Definition:</b> <a href="composite__graph_8hpp_source.html#l00018">composite_graph.hpp:18</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_match_result_html_ae782d9a7ce9a6718f92149e87b17f9fd"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_match_result.html#ae782d9a7ce9a6718f92149e87b17f9fd">FMM::MM::MatchResult::opath</a></div><div class="ttdeci">O_Path opath</div><div class="ttdoc">the optimal path, containing id of edges matched to each point in a trajectory</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00074">mm_type.hpp:74</a></div></div>
<div class="ttc" id="anamespace_f_m_m_1_1_n_e_t_w_o_r_k_html"><div class="ttname"><a href="namespace_f_m_m_1_1_n_e_t_w_o_r_k.html">FMM::NETWORK</a></div><div class="ttdoc">Classes related with network and graph.</div><div class="ttdef"><b>Definition:</b> <a href="graph_8hpp_source.html#l00021">graph.hpp:21</a></div></div>
<div class="ttc" id="anamespace_f_m_m_1_1_m_m_html_a5fe5a4a7accb676f64dd1a9ac74ddcac"><div class="ttname"><a href="namespace_f_m_m_1_1_m_m.html#a5fe5a4a7accb676f64dd1a9ac74ddcac">FMM::MM::O_Path</a></div><div class="ttdeci">std::vector&lt; FMM::NETWORK::EdgeID &gt; O_Path</div><div class="ttdoc">Optimal path, edge id matched to each point in the trajectory.</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00044">mm_type.hpp:44</a></div></div>
<div class="ttc" id="aclass_f_m_m_1_1_m_m_1_1_fast_map_match_html_a5d29d69038868b06a9c31f762bab67f4"><div class="ttname"><a href="class_f_m_m_1_1_m_m_1_1_fast_map_match.html#a5d29d69038868b06a9c31f762bab67f4">FMM::MM::FastMapMatch::match_traj</a></div><div class="ttdeci">MatchResult match_traj(const CORE::Trajectory &amp;traj, const FastMapMatchConfig &amp;config)</div><div class="ttdoc">Match a trajectory to the road network.</div><div class="ttdef"><b>Definition:</b> <a href="fmm__algorithm_8cpp_source.html#l00051">fmm_algorithm.cpp:51</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result_html_ac7693d8ab7b07ad23fe96aa3e1244fc0"><div class="ttname"><a href="struct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result.html#ac7693d8ab7b07ad23fe96aa3e1244fc0">FMM::PYTHON::PyMatchResult::id</a></div><div class="ttdeci">int id</div><div class="ttdoc">id of a trajectory</div><div class="ttdef"><b>Definition:</b> <a href="pyfmm_8hpp_source.html#l00040">pyfmm.hpp:40</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_record_html_a5a80f019d6d600a0d43f2680be3d09a7"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_record.html#a5a80f019d6d600a0d43f2680be3d09a7">FMM::MM::Record::cost</a></div><div class="ttdeci">double cost</div><div class="ttdoc">distance from source to target</div><div class="ttdef"><b>Definition:</b> <a href="ubodt_8hpp_source.html#l00029">ubodt.hpp:29</a></div></div>
<div class="ttc" id="anamespace_f_m_m_1_1_c_o_r_e_html_a0b687e932225892c4d165994b67f07b1"><div class="ttname"><a href="namespace_f_m_m_1_1_c_o_r_e.html#a0b687e932225892c4d165994b67f07b1">FMM::CORE::wkt2linestring</a></div><div class="ttdeci">LineString wkt2linestring(const std::string &amp;wkt)</div><div class="ttdoc">Convert a wkt into a linestring.</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00042">geometry.cpp:42</a></div></div>
<div class="ttc" id="aclass_f_m_m_1_1_m_m_1_1_fast_map_match_html_ad4b0b5f016bfc712dad4db3c10c2c8e0"><div class="ttname"><a href="class_f_m_m_1_1_m_m_1_1_fast_map_match.html#ad4b0b5f016bfc712dad4db3c10c2c8e0">FMM::MM::FastMapMatch::update_tg</a></div><div class="ttdeci">void update_tg(TransitionGraph *tg, const CORE::Trajectory &amp;traj, const FastMapMatchConfig &amp;config)</div><div class="ttdoc">Update probabilities in a transition graph.</div><div class="ttdef"><b>Definition:</b> <a href="fmm__algorithm_8cpp_source.html#l00142">fmm_algorithm.cpp:142</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_match_result_html_a4aee2d2327e9f6f4029179cb176cb8e6"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_match_result.html#a4aee2d2327e9f6f4029179cb176cb8e6">FMM::MM::MatchResult::indices</a></div><div class="ttdeci">std::vector&lt; int &gt; indices</div><div class="ttdoc">index of opath edge in cpath</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00080">mm_type.hpp:80</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_matched_candidate_html"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_matched_candidate.html">FMM::MM::MatchedCandidate</a></div><div class="ttdoc">A candidate matched to a point.</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00053">mm_type.hpp:53</a></div></div>
<div class="ttc" id="aclass_f_m_m_1_1_m_m_1_1_transition_graph_html_a0524ced137b747586da15ed28da4712f"><div class="ttname"><a href="class_f_m_m_1_1_m_m_1_1_transition_graph.html#a0524ced137b747586da15ed28da4712f">FMM::MM::TransitionGraph::get_layers</a></div><div class="ttdeci">std::vector&lt; TGLayer &gt; &amp; get_layers()</div><div class="ttdoc">Get a reference to the inner layers of the transition graph.</div><div class="ttdef"><b>Definition:</b> <a href="transition__graph_8cpp_source.html#l00086">transition_graph.cpp:86</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge_html_ac0978bf50901e262c32ae0b6de29e2d5"><div class="ttname"><a href="struct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge.html#ac0978bf50901e262c32ae0b6de29e2d5">FMM::NETWORK::Edge::source</a></div><div class="ttdeci">NodeIndex source</div><div class="ttdoc">source node index</div><div class="ttdef"><b>Definition:</b> <a href="type_8hpp_source.html#l00049">type.hpp:49</a></div></div>
<div class="ttc" id="anamespace_f_m_m_1_1_n_e_t_w_o_r_k_html_afb9b00547afc39bc77ee8eb3d07f9bc5"><div class="ttname"><a href="namespace_f_m_m_1_1_n_e_t_w_o_r_k.html#afb9b00547afc39bc77ee8eb3d07f9bc5">FMM::NETWORK::NodeIndex</a></div><div class="ttdeci">unsigned int NodeIndex</div><div class="ttdoc">Node Index in the network, range from [0,num_vertices-1 ].</div><div class="ttdef"><b>Definition:</b> <a href="type_8hpp_source.html#l00024">type.hpp:24</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_fast_map_match_config_html_a313354473aee028ba93a7a695a62f121"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#a313354473aee028ba93a7a695a62f121">FMM::MM::FastMapMatchConfig::validate</a></div><div class="ttdeci">bool validate() const</div><div class="ttdoc">Check if the configuration is valid or not.</div><div class="ttdef"><b>Definition:</b> <a href="fmm__algorithm_8cpp_source.html#l00042">fmm_algorithm.cpp:42</a></div></div>
<div class="ttc" id="anamespace_f_m_m_1_1_a_l_g_o_r_i_t_h_m_html_af621c133a7effad2cbea9e614367818a"><div class="ttname"><a href="namespace_f_m_m_1_1_a_l_g_o_r_i_t_h_m.html#af621c133a7effad2cbea9e614367818a">FMM::ALGORITHM::cal_eu_dist</a></div><div class="ttdeci">std::vector&lt; double &gt; cal_eu_dist(const FMM::CORE::LineString &amp;trajectory)</div><div class="ttdoc">Calculate segment length of a trajectory.</div><div class="ttdef"><b>Definition:</b> <a href="geom__algorithm_8cpp_source.html#l00007">geom_algorithm.cpp:7</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_record_html"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_record.html">FMM::MM::Record</a></div><div class="ttdoc">Record type of the upper bounded origin destination table</div><div class="ttdef"><b>Definition:</b> <a href="ubodt_8hpp_source.html#l00023">ubodt.hpp:23</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result_html_ad9f43bde5a423fa7aa1b5d3bc0d9d1f1"><div class="ttname"><a href="struct_f_m_m_1_1_p_y_t_h_o_n_1_1_py_match_result.html#ad9f43bde5a423fa7aa1b5d3bc0d9d1f1">FMM::PYTHON::PyMatchResult::cpath</a></div><div class="ttdeci">MM::C_Path cpath</div><div class="ttdoc">Edge ID traversed by the matched path.</div><div class="ttdef"><b>Definition:</b> <a href="pyfmm_8hpp_source.html#l00042">pyfmm.hpp:42</a></div></div>
<div class="ttc" id="aclass_f_m_m_1_1_c_o_r_e_1_1_line_string_html_af84353cda3ddae7afbac33883be29145"><div class="ttname"><a href="class_f_m_m_1_1_c_o_r_e_1_1_line_string.html#af84353cda3ddae7afbac33883be29145">FMM::CORE::LineString::get_num_points</a></div><div class="ttdeci">int get_num_points() const</div><div class="ttdoc">Get the number of points in a line.</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8hpp_source.html#l00115">geometry.hpp:115</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge_html_a54256643086396646fbf2611ef708ea4"><div class="ttname"><a href="struct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge.html#a54256643086396646fbf2611ef708ea4">FMM::NETWORK::Edge::length</a></div><div class="ttdeci">double length</div><div class="ttdoc">length of the edge polyline</div><div class="ttdef"><b>Definition:</b> <a href="type_8hpp_source.html#l00051">type.hpp:51</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_t_g_node_html"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_t_g_node.html">FMM::MM::TGNode</a></div><div class="ttdoc">A node in the transition graph.</div><div class="ttdef"><b>Definition:</b> <a href="transition__graph_8hpp_source.html#l00029">transition_graph.hpp:29</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_matched_candidate_html_a69781988abe154fd11693071be8d39b8"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_matched_candidate.html#a69781988abe154fd11693071be8d39b8">FMM::MM::MatchedCandidate::sp_dist</a></div><div class="ttdeci">double sp_dist</div><div class="ttdoc">shortest path distance to previous matched candidate</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00057">mm_type.hpp:57</a></div></div>
<div class="ttc" id="anamespace_f_m_m_1_1_m_m_html_acc79b4661cbb37632647cb2a8125e551"><div class="ttname"><a href="namespace_f_m_m_1_1_m_m.html#acc79b4661cbb37632647cb2a8125e551">FMM::MM::TGLayer</a></div><div class="ttdeci">std::vector&lt; TGNode &gt; TGLayer</div><div class="ttdoc">A layer of nodes in the transition graph.</div><div class="ttdef"><b>Definition:</b> <a href="transition__graph_8hpp_source.html#l00042">transition_graph.hpp:42</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_fast_map_match_config_html"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html">FMM::MM::FastMapMatchConfig</a></div><div class="ttdoc">Configuration class for fmm algorithm.</div><div class="ttdef"><b>Definition:</b> <a href="fmm__algorithm_8hpp_source.html#l00030">fmm_algorithm.hpp:30</a></div></div>
<div class="ttc" id="anamespace_f_m_m_1_1_p_y_t_h_o_n_html"><div class="ttname"><a href="namespace_f_m_m_1_1_p_y_t_h_o_n.html">FMM::PYTHON</a></div><div class="ttdoc">Data type for Python API.</div><div class="ttdef"><b>Definition:</b> <a href="pyfmm_8hpp_source.html#l00019">pyfmm.hpp:19</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge_html_aea442fa7c944e87b2aea41ffb175982d"><div class="ttname"><a href="struct_f_m_m_1_1_n_e_t_w_o_r_k_1_1_edge.html#aea442fa7c944e87b2aea41ffb175982d">FMM::NETWORK::Edge::target</a></div><div class="ttdeci">NodeIndex target</div><div class="ttdoc">target node index</div><div class="ttdef"><b>Definition:</b> <a href="type_8hpp_source.html#l00050">type.hpp:50</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_matched_candidate_html_a41a90b037fa57a4d097fb5a13ed2ce70"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_matched_candidate.html#a41a90b037fa57a4d097fb5a13ed2ce70">FMM::MM::MatchedCandidate::ep</a></div><div class="ttdeci">double ep</div><div class="ttdoc">emission probability</div><div class="ttdef"><b>Definition:</b> <a href="mm__type_8hpp_source.html#l00055">mm_type.hpp:55</a></div></div>
<div class="ttc" id="astruct_f_m_m_1_1_m_m_1_1_fast_map_match_config_html_ac9b20f003bc1167c84cf221eec283d63"><div class="ttname"><a href="struct_f_m_m_1_1_m_m_1_1_fast_map_match_config.html#ac9b20f003bc1167c84cf221eec283d63">FMM::MM::FastMapMatchConfig::load_from_arg</a></div><div class="ttdeci">static FastMapMatchConfig load_from_arg(const cxxopts::ParseResult &amp;arg_data)</div><div class="ttdoc">Load configuration from argument data.</div><div class="ttdef"><b>Definition:</b> <a href="fmm__algorithm_8cpp_source.html#l00034">fmm_algorithm.cpp:34</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
